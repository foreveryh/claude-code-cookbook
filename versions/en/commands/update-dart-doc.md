## Update Dart Doc

Systematically manage DartDoc comments in Dart files and maintain high-quality English documentation.

### Usage

```bash
# Add new comments and update existing ones simultaneously
"Add DartDoc comments to classes without comments and update comments that don't meet standards"

# Check PR changed files
"Check if the files changed in PR #4308 have Claude markers in their DartDoc"

# Document specific directory
"Add DartDoc to Widget classes under packages/app/lib/ui/screen/"

# Run without marker
/update-dart-doc --marker false
"Improve DartDoc in existing project (without adding Claude markers)"
```

### Options

- `--marker <true|false>` : Whether to add Claude markers (default: true)

### Basic Examples

```bash
# 1. Analyze target files
find . -name "*.dart" -not -path "*/.*" | grep -v "_test.dart" | grep -v "_vrt.dart"
"Identify classes lacking DartDoc (comment lines 0 or less than 30 characters)"

# 2. Add documentation
"Add DartDoc comments with required elements to the identified classes"

# 3. Verify markers
"Confirm all added/updated DartDoc have Claude markers"
```

### Execution Steps

#### 1. Target Element Priority

1. üî¥ **Highest Priority**: Elements without DartDoc comments (0 comment lines)
2. üü° **Medium Priority**: Elements not meeting standards (less than 30 characters or missing required elements)
3. üü¢ **Review Target**: Existing comments without Claude markers

**Target Elements**:

- Class (all class definitions)
- Enum (enumeration types)
- Extension (extension methods)
- Important functions (top-level functions, optional)

#### 2. DartDoc Writing Rules

**Basic Structure**:

```dart
/// {Element overview description} (30-60 characters, required)
///
/// {Detailed description} (must include role, usage context, and notes, 50-200 characters)
///
/// Generated by Claude ü§ñ
@Annotation  // Don't change existing annotations
class ClassName {
```

**Writing Style**:

- Professional tone: "Displays", "Manages the class"
- Use periods and commas appropriately
- Add space between English and numbers
- Technical terms in English: "Authentication state"
- Keep each line within 80 characters

#### 3. Class Category Examples

**State Management Class (Riverpod)**:

```dart
/// State that manages horizontal swipe gesture disable status.
///
/// Used when horizontal swipe needs to be disabled during specific screens
/// or operations. For example, during carousel display or specific input.
///
/// Generated by Claude ü§ñ
@Riverpod(keepAlive: true, dependencies: [])
class HorizontalDragGestureIgnoreState extends _$HorizontalDragGestureIgnoreState {
```

**Widget Class**:

```dart
/// Widget that displays user profile.
///
/// Arranges avatar image, username, and status information vertically,
/// navigates to profile detail screen on tap.
///
/// Generated by Claude ü§ñ
class UserProfileWidget extends HookConsumerWidget {
```

#### 4. Existing Content Retention Rules

1. **When existing comments meet standards**: Keep as is (don't add new)
   - Standards: 30+ characters and includes required elements (overview, details, marker)
2. **When existing comments don't meet standards**: Completely replace (avoid duplication)
3. **When no existing comments**: Add new comment

**Important Information to Preserve**:

- URLs and links: References starting with `See also:`
- TODO comments: `TODO(user_name):` format
- Important notes: Warnings like `Note:` or `Warning:`
- Usage examples: Code starting with `Example:`
- Technical constraints: Performance or limitation descriptions

### Claude Marker Management

```bash
# Marker format
/// Generated by Claude ü§ñ

# Check markers in PR changed files
gh pr diff 4308 --name-only | grep "\.dart$" | xargs grep -l "Generated by Claude"
"Add markers to files without them"
```

### Quality Checklist

- ‚úÖ **Character count**: Strictly follow 30-60 chars for overview, 50-200 chars for details
- ‚úÖ **Required elements**: Must include all 3 elements: overview, detailed description, Claude marker
- ‚úÖ **Completeness**: Include role, usage context, and notes
- ‚úÖ **Consistency**: Maintain professional tone throughout
- ‚úÖ **Formatting**: Add space between words and numbers
- ‚úÖ **Accuracy**: Analyze implementation, only describe facts
- ‚úÖ **Structure**: Preserve annotations, place comments above
- ‚úÖ **Length**: Keep each line within 80 characters
- ‚úÖ **Marker**: Always add marker for Claude changes

### Important Notes

**üî¥ Absolutely Prohibited**:

- ‚ùå Code changes other than documentation comments
- ‚ùå Speculation about implementation details (only state facts)
- ‚ùå Unnatural mixing of languages
- ‚ùå Deleting or changing existing annotations
- ‚ùå Duplicating existing comments
- ‚ùå Comments below character standards for test files (`*_test.dart`)
- ‚ùå Comments below character standards for VRT files (`*_vrt.dart`)

**Static Analysis and Commit**:

```bash
# Record execution results
ADDED_COMMENTS=0
UPDATED_COMMENTS=0
ERRORS=0

# Verify after changes
melos analyze
if [ $? -ne 0 ]; then
  echo "üî¥ Error: Static analysis failed"
  exit 1
fi

# Output execution summary
echo "üìä Execution Results:"
echo "- Added comments: $ADDED_COMMENTS"
echo "- Updated comments: $UPDATED_COMMENTS"
echo "- Errors: $ERRORS"

# Commit example
git commit -m "docs: Add and update DartDoc comments

- Add DartDoc to classes, enums, extensions not meeting standards
- Update comments under 30 characters to meet standards
- Uniformly apply Claude markers

Results:
- Added: $ADDED_COMMENTS
- Updated: $UPDATED_COMMENTS

Generated by Claude ü§ñ"
```

### Success Criteria

1. **Complete Success**: When all following conditions are met
   - `melos analyze` shows PASSED
   - Error count is 0
   - All added/updated comments meet standards

2. **Partial Success**: When
   - Error count is less than 5
   - 90% or more meet standards

3. **Failure**: When
   - `melos analyze` shows FAILED
   - Error count is 5 or more
